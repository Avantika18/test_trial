<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Dashboard - Bootstrap Admin Template</title>
<style>
.heading{
color:#f7941d;
font-size:20px;
}

.go_right{
float:right;
}

#mapDD {
    padding:3px;
    margin: 1px;
    -webkit-border-radius:4px;
    -moz-border-radius:4px;
    border-radius:4px;
    -webkit-box-shadow: 0 3px 0 #ccc, 0 -1px #fff inset;
    -moz-box-shadow: 0 0px 0 #ccc, 0 -1px #fff inset;
    box-shadow: 0 0px 0 #ccc, 0 -1px #fff inset;
    background: #fff;
    color:#f7941d;
    font-size : 18px;
    /*border:none;*/
    outline:none;
    display: inline-block;
    
    -moz-appearance:none;
    appearance:none;
    cursor:pointer;
}

@media screen and (-webkit-min-device-pixel-ratio:0) {
    #mapDD {padding-right:18px}
}

 #mapDD label {position:relative}
 #mapDD label:after {
    content:'<>';
    font:11px "Consolas", monospace;
    color:#aaa;
    -webkit-transform:rotate(90deg);
    -moz-transform:rotate(90deg);
    -ms-transform:rotate(90deg);
    transform:rotate(90deg);
    right:8px; top:2px;
    padding:0 0 2px;
    border-bottom:1px solid #ddd;
    position:absolute;
    pointer-events:none;
}
 #mapDD label:before {
    content:'';
    right:6px; top:0px;
    width:20px; height:20px;
    background:#f8f8f8;
    position:absolute;
    pointer-events:none;
    display:block;
   
}
</style>
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/bootstrap-responsive.min.css" rel="stylesheet">
<link
	href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600"
	rel="stylesheet">
<link href="css/font-awesome.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet">
<link href="css/datepicker3.css" rel="stylesheet">
<link href="css/pages/dashboard.css" rel="stylesheet">
<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body onload="pickDate();">
	<div class="navbar navbar-fixed-top">

		<div class="navbar-inner">

			<div class="container">

				<!--<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</a>-->

				<a class="brand"> <img src="img/logo_new.png" class="logo" />
				</a> <select style="width: 200px; position: relative; top: 22px;"
					id="categoryDD" onchange="change_category();">
					<option value="crime">Crime</option>
					<option value="electriciy_and_power">Electriciy And Power</option>
					<option value="garbage">Garbage</option>
					<option value="illegal_parking">Illegal parking</option>
					<option value="pollution">Pollution</option>
					<option value="public_transport">Public Transport</option>
					<option value="roads_and_footpath">Road And Footpath</option>
					<option value="sewage_and_drains">Sewage And Drains</option>
					<option value="traffic">Traffic</option>
					<option value="water">Water</option>
				</select> <span style="position: relative; top: 20px; margin-left: 120px;">
					<button type="button" class="btn btn-small">Home</button>



					<button type="button" class="btn btn-small">Issues</button>




					<button type="button" class="btn btn-small active" id="citystatBut"
						onclick="onClickOfStat();">City Statistics</button> <span>


						<div class="nav-collapse">
							<ul class="nav pull-right" style="bottom: 31px;">
								<li class="dropdown"><a href="#" class="dropdown-toggle"
									data-toggle="dropdown"> <i></i> Hello Admin <b
										class="caret"></b>
								</a>

									<ul class="dropdown-menu">
										<li><a href="javascript:;">Settings</a></li>
										<li><a href="javascript:;">Help</a></li>
									</ul></li>



								<li class="dropdown"><a href="#"> Logout </a></li>



							</ul>



						</div>
						<!--/.nav-collapse -->
			</div>
			<!-- /container -->

		</div>
		<!-- /navbar-inner -->

	</div>
	<!-- /navbar -->

	<div class="main" style="padding-top: 30px;">
		<div class="main-inner">
			<div class="container">
				<div class="row">
					<div class="span5">

						<div class="widget">

							<div class="widget-content"  style="height:200px;">
								<img src="img/location.png" alt="Smiley face" height="170"
									width="170"> 
									
								<div id="heading_parent1" class="go_right">
								<span id="heading1" style="color:#f7941d;font-size:20px;"><b>HIGH</b> COMPLAIN AREA</span>
								</div>	
									<div class="pull-right" id="high_places">
			<!-- 						<div id="one" style="font-size:23px;margin-right:25px;margin-top:30px;"> &nbsp; Marathahalli &nbsp;&nbsp; <font color="gray">45%</font></div>
								<br>
								<div id="two" style="font-size:18px;margin-left:30px;margin-top:-10px;color:gray;">Marathahalli &nbsp;&nbsp; <font color="gray">45%</font>
								</div>
								<br>
								<div id="three" style="font-size:15px;margin-left:40px;margin-top:-12px;color:gray;">Marathahalli &nbsp;&nbsp; <font color="gray">45%</font>
								</div>  -->
								</div>
								
							</div>
							<!-- /widget-content -->

						</div>
						<!-- /widget -->

					</div>
					<!-- /span12 -->

					<div class="span7">

						<div class="widget">

							<div class="widget-content" id="map_parent">

								<div id="rep_parent" style="float: right">
									<select id= "mapDD" size="1" onchange="change_map();">
										<option value="e" selected>EAST BANGALORE</option>
										<option value="w">WEST BANGALORE</option>
										<option value="n">NORTH BANGALORE</option>
										<option value="s">SOUTH BANGALORE</option>
									</select>
									
<!-- 									<div id="o" style="margin-top:10px;font-size:23px;margin-top:30px;text-align:right;color:#08088A;">Marathahalli 45 <font size="2px">new Reports</font></div><br>
									<div id="t" style="margin-top:-10px;font-size:18px;text-align:right;color:#2E2EFE">Marathahalli 45 <font size="2px">new Reports</font></div><br>
									<div id="th" style="margin-top:-10px;font-size:14px;text-align:right;color:#2E2EFE">Marathahalli 45 <font size="2px">new Reports</font></div>
	 -->								
								</div>
								<object id="map" type="text/html" width="300px" height="200px"
									data="cloropeth.html"></object>
							</div>
							<!-- /widget-content -->

						</div>
						<!-- /widget -->

					</div>
					<!-- /span12 -->


					<div class="span8">

						<div class="widget">

							<div class="widget-content" id="trend_parent">
	<div style="color:#f7941d;font-size:20px;text-align:center;"> REPORT <b>TREND</b></div>
								<object id="trend" type="text/html" width="100%" height="335px"
									data="stockchart.html"></object>
							</div>
							<!-- /widget-content -->

						</div>
						<!-- /widget -->

					</div>
					<!-- /span12 -->

					<div class="span4">

						<div class="widget">

							<div class="widget-content" id="status_parent">
								<div style="color:#f7941d;font-size:20px;text-align:center;">ISSUE <b>STATUS</b></div>
								<object id="status" type="text/html" width="100%" height="335px"
									data="pie.html"></object>
							</div>
							<!-- /widget-content -->

						</div>
						<!-- /widget -->

					</div>
					<!-- /span12 -->

					<div class="span5">

						<div class="widget">

							<div class="widget-content" style="height:554px;" id="type_parent">
							<div style="color:#f7941d;font-size:20px;text-align:center;margin-bottom:40px;">ISSUE <b>TYPE</b></div>
								<object id="type" type="text/html" width="400px" height="480px"
									data="sub_category.html" overflow="hidden"></object>
							</div>
							<!-- /widget-content -->

						</div>
						<!-- /widget -->

					</div>
					<!-- /span12 -->

					<div class="span7">

						<div class="widget">

							<div class="widget-content" id="s_parent">
							<div style="color:#f7941d;font-size:20px;text-align:center;"><b>STALENESS</b> OF UNRESOLVED ISSUES</div>
								<object id="staleness" type="text/html" width="100%" height="250px;"
									data="staleness_trial.html" overflow="hidden"></object>
							<div id="change" style="color:#f7941d;font-size:20px;text-align:center;"><b>SEVERITY</b> OF UNRESOVED ISSUES</div>
								<object id="severity" type="text/html" width="100%" height="250px;"
									data="scatter.html" overflow="hidden"></object>
							</div>
							<!-- /widget-content -->

						</div>
						<!-- /widget -->

					</div>
					<!-- /span12 -->




				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /main-inner -->
	</div>
	<!-- /main -->

	<!-- /extra -->

	<!-- /footer -->
	<!-- Le javascript
================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="js/jquery-1.7.2.min.js"></script>
	<script src="js/excanvas.min.js"></script>
	<script src="js/chart.min.js" type="text/javascript"></script>
	<script src="js/bootstrap.js"></script>
	<script language="javascript" type="text/javascript"
		src="js/full-calendar/fullcalendar.min.js"></script>

	<script src="js/base.js"></script>
	<script src="js/bootstrap-datepicker.js"></script>
	<script type="text/javascript">
	
	function generate_city_high(cat){
		console.log("in here");
		var request;
	    var chartData=[];
	    if (window.XMLHttpRequest) {
	        request = new XMLHttpRequest();
			
			var url = "http://23.253.71.50:8080/cityZenServer/rest/statistics/getTopAreasWithPercentReports/"+cat;
		    //request.open('GET', "trends2.json", false);
			//url = "name.json";
		    request.open('GET',url, false);
		    request.send();
		    var d = JSON.parse(request.responseText);
		    
		    //console.log(d[1][1]);
		    for (var i = 0; i < d.length; i=i+1) {
		    
		        var place = d[i][0];
		        var percent = d[i][1];
		  
		        chartData.push({
		            place: place,
		            value: percent
		        });
		        
		    }
		    
		    return chartData;
		   //setData(request.responseText);
	    }
	}
		
	function generate_reports_high(cat)
	{
		var request;
	    var chartData=[];
	    if (window.XMLHttpRequest) {
	        request = new XMLHttpRequest();
			
			var url = "http://23.253.71.50:8080/cityZenServer/rest/statistics/getTopAreasWithReportCount/"+cat;
		    //request.open('GET', "trends2.json", false);
			//url = "report.json";
		    request.open('GET',url, false);
		    request.send();
		    var d = JSON.parse(request.responseText);
			console.log(d);
		    //console.log(d[1][1]);
		    for (var i = 0; i < d.length; i=i+1) {
		    
		        var place = d[i][0];
		        var percent = d[i][1];
		  		if(i== d.length-1)
		  			{
		  			var a= d[i].recentIntervalDays;
		  			chartData.push({
			            place: "time",
			            value: a
			        });
		  			}
		  		else{
		        chartData.push({
		            place: place,
		            value: percent
		        });
		  		}
		        
		    }
			
		    return chartData;
		   //setData(request.responseText);
	    }
	}
	
	function change_category()
	{
		
		var e = document.getElementById("categoryDD");
		var strUser = e.options[e.selectedIndex].value;
		sessionStorage.setItem("category",strUser);	
		console.log(strUser);
		
		
	// hight category tab
	var d = document.getElementById('heading_parent1');
	var olddiv = document.getElementById('heading1');
	d.removeChild(olddiv);
	
	var ni = document.getElementById('heading_parent1');
	var newdiv = document.createElement('span');
	var divIdName = 'heading1';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','color:#f7941d;font-size:20px;');
	newdiv.innerHTML = '<b>HIGH</b> COMPLAIN AREA';
	ni.appendChild(newdiv);	
	
	
	var d = document.getElementById('high_places');
	var olddiv = document.getElementById('one');
	d.removeChild(olddiv);
	var olddiv = document.getElementById('two');
	d.removeChild(olddiv);
	var olddiv = document.getElementById('three');
	d.removeChild(olddiv);

	var a="crime";
	if(sessionStorage.getItem("category"))
	var a = sessionStorage.getItem("category");	
	var data= generate_city_high(a);
	console.log(data[0].place);
	
	var ni = document.getElementById('high_places');
    var newdiv = document.createElement('div');
	var divIdName = 'one';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','font-size:23px;text-align:right;margin-top:-100px;margin-bottom:20px;');
	if(data.length>0){
	newdiv.innerHTML = '&nbsp;'+data[0].place+' &nbsp;&nbsp; <font color="gray">'+data[0].value+'%</font><br>';
	}
	else{
		newdiv.innerHTML="";
	}
	ni.appendChild(newdiv);
	
	
	var newdiv = document.createElement('div');
	var divIdName = 'two';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','font-size:18px;margin-left:35px;margin-top:-10px;color:gray;margin-bottom:20px;text-align:right;');
	if(data.length>1){
	newdiv.innerHTML =  data[1].place+'&nbsp;&nbsp; <font color="gray">'+data[1].value+'%</font><br>';
	}
	else{
		newdiv.innerHTML =  '';
	}
	ni.appendChild(newdiv);
	
	
	
	var newdiv = document.createElement('div');
	var divIdName = 'three';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','font-size:15px;margin-left:40px;margin-top:-12px;color:gray;margin-bottom:0px;text-align:right;');
	if(data.length>2){
	newdiv.innerHTML = data[2].place+'&nbsp;&nbsp; <font color="gray">'+data[2].value+'%</font><br>';}
	else{
		newdiv.innerHTML =  '';
	}
	ni.appendChild(newdiv);
			
	//
	

	var a="crime";
	if(sessionStorage.getItem("category"))
	var a = sessionStorage.getItem("category");
	var data =generate_reports_high("crime");
	
	var data =generate_reports_high(a);
	

	var d = document.getElementById('rep_parent');
	var olddiv = document.getElementById('o');
	d.removeChild(olddiv);
	var olddiv = document.getElementById('t');
	d.removeChild(olddiv);
	var olddiv = document.getElementById('th');
	d.removeChild(olddiv);

	var ni = document.getElementById('rep_parent');
    var newdiv = document.createElement('div');
	var divIdName = 'o';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','margin-top:10px;font-size:20px;margin-top:20px;text-align:right;color:#08088A;margin-bottom:20px;');
	if(data.length>0){
	newdiv.innerHTML = data[0].place +" " +data[0].value + '<font size="2px"> new Reports in ' + data[data.length-1].value + ' days </font>';}
	else{
		newdiv.innerHTML="";
	}
	ni.appendChild(newdiv);
	
	var newdiv = document.createElement('div');
	var divIdName = 't';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','margin-top:-10px;font-size:16px;text-align:right;color:#2E2EFE;margin-bottom:20px;');
	if(data.length>1){
	newdiv.innerHTML =   data[1].place +" " +data[1].value + '<font size="2px"> new Reports in ' + data[data.length-1].value + ' days </font>';}
	else{
		newdiv.innerHTML="";
	}
	ni.appendChild(newdiv);
	
	var newdiv = document.createElement('div');
	var divIdName = 'th';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','margin-top:-10px;font-size:14px;text-align:right;color:#2E2EFE;margin-bottom:20px;');
	if(data.length>2){
	newdiv.innerHTML =  data[2].place +" " +data[2].value + '<font size="2px"> new Reports in ' + data[data.length-1].value + ' days </font>';}
	else{
		newdiv.innerHTML="";
	}
	ni.appendChild(newdiv);
							

	
	
	// map
		
		
	var d = document.getElementById('map_parent');
	var olddiv = document.getElementById('map');
	d.removeChild(olddiv);

	var ni = document.getElementById('map_parent');
    var newdiv = document.createElement('object');
	var divIdName = 'map';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('type','text/html');
	newdiv.setAttribute('width','300px');
	newdiv.setAttribute('height','200px');
	newdiv.setAttribute('data','cloropeth.html');
	ni.appendChild(newdiv);
		
		// trends
		
	

		
	var d = document.getElementById('trend_parent');
	var olddiv = document.getElementById('trend');
	d.removeChild(olddiv);

	var ni = document.getElementById('trend_parent');
    var newdiv = document.createElement('object');
	var divIdName = 'trend';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('type','text/html');
	newdiv.setAttribute('width','100%');
	newdiv.setAttribute('height','335px');
	newdiv.setAttribute('data','stockchart.html');
	ni.appendChild(newdiv);
	
		// status
	
	var d = document.getElementById('status_parent');
	var olddiv = document.getElementById('status');
	d.removeChild(olddiv);

	var ni = document.getElementById('status_parent');
    var newdiv = document.createElement('object');
	var divIdName = 'status';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('type','text/html');
	newdiv.setAttribute('width','100%');
	newdiv.setAttribute('height','335px');
	newdiv.setAttribute('data','pie.html');
	ni.appendChild(newdiv);
		
		//type
		
	var d = document.getElementById('type_parent');
	var olddiv = document.getElementById('type');
	d.removeChild(olddiv);

	var ni = document.getElementById('type_parent');
    var newdiv = document.createElement('object');
	var divIdName = 'type';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('type','text/html');
	newdiv.setAttribute('width','400px');
	newdiv.setAttribute('height','480px');
	newdiv.setAttribute('data','sub_category.html');
	newdiv.setAttribute('overflow','hidden');
	ni.appendChild(newdiv);
		
	//staleness
	
	var d = document.getElementById('s_parent');
	var olddiv = document.getElementById('staleness');
	d.removeChild(olddiv);

	var ni = document.getElementById('s_parent');
    var newdiv = document.createElement('object');
	var divIdName = 'staleness';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('type','text/html');
	newdiv.setAttribute('width','100%');
	newdiv.setAttribute('height','250px');
	newdiv.setAttribute('data','staleness_trial.html');
	newdiv.setAttribute('overflow','hidden');
	ni.appendChild(newdiv);		
	
	//severity
	
	//heading & object
	
	var d = document.getElementById('s_parent');
	var olddiv = document.getElementById('severity');
	d.removeChild(olddiv);

	var olddiv = document.getElementById('change');
	d.removeChild(olddiv);


	var ni = document.getElementById('s_parent');
    var newdiv = document.createElement('div');
	var divIdName = 'change';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','color:#f7941d;font-size:20px;text-align:right;');
    newdiv.innerHTML = '<b>SEVERITY</b> OF UNRESOVED ISSUES';
	ni.appendChild(newdiv);

	
	var ni = document.getElementById('s_parent');
    var newdiv = document.createElement('object');
	var divIdName = 'severity';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('type','text/html');
	newdiv.setAttribute('width','100%');
	newdiv.setAttribute('height','250px');
	newdiv.setAttribute('data','scatter.html');
	newdiv.setAttribute('overflow','hidden');
	ni.appendChild(newdiv);
		
	}
	
	function change_map(){
	var e = document.getElementById("mapDD");
	var strUser = e.options[e.selectedIndex].value;
	sessionStorage.setItem("orientation",strUser);

	var d = document.getElementById('map_parent');
	var olddiv = document.getElementById('map');
	d.removeChild(olddiv);

	var ni = document.getElementById('map_parent');
    var newdiv = document.createElement('object');
	var divIdName = 'map';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('type','text/html');
	newdiv.setAttribute('width','300px');
	newdiv.setAttribute('height','200px');
	newdiv.setAttribute('data','cloropeth.html');
	ni.appendChild(newdiv);

	
	}
		function pickDate() {
			var data = generate_city_high("crime");
			

			var ni = document.getElementById('high_places');
		    var newdiv = document.createElement('div');
			var divIdName = 'one';
			newdiv.setAttribute('id',divIdName);
			newdiv.setAttribute('style','font-size:23px;text-align:right;margin-top:-100px;margin-bottom:20px;');
			if(data.length>0){
			newdiv.innerHTML = '&nbsp;'+data[0].place+' &nbsp;&nbsp; <font color="gray">'+data[0].value+'%</font><br>';
			}
			else{
				newdiv.innerHTML="";
			}
			ni.appendChild(newdiv);
			
			var newdiv = document.createElement('div');
			var divIdName = 'two';
			newdiv.setAttribute('id',divIdName);
			newdiv.setAttribute('style','font-size:18px;margin-left:35px;margin-top:-10px;text-align:right;color:gray;margin-bottom:20px;');
			if(data.length>1){
			newdiv.innerHTML =  data[1].place+'&nbsp;&nbsp; <font color="gray">'+data[1].value+'%</font><br>';}
			else{
				newdiv.innerHTML ="";
			}
			ni.appendChild(newdiv);
			
			var newdiv = document.createElement('div');
			var divIdName = 'three';
			newdiv.setAttribute('id',divIdName);
			
			newdiv.setAttribute('style','font-size:15px;margin-left:40px;margin-top:-12px;color:gray;margin-bottom:0px;text-align:right;');
		
			if(data.length>2){
			newdiv.innerHTML = data[2].place+'&nbsp;&nbsp; <font color="gray">'+data[2].value+'%</font><br>';}
			else
			{
			newdiv.innerHTML="";
			}
			ni.appendChild(newdiv);
									
			//

				
	var data =generate_reports_high("crime");
	console.log(data.length);

	var ni = document.getElementById('rep_parent');
    var newdiv = document.createElement('div');
	var divIdName = 'o';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','margin-top:10px;font-size:20px;margin-top:20px;text-align:right;color:#08088A;margin-bottom:20px;');
	if(data.length>0){
	newdiv.innerHTML = data[0].place +" " +data[0].value + '<font size="2px"> new Reports in ' + data[data.length-1].value + ' days </font>';}
	else{
		newdiv.innerHTML="";
	}
	ni.appendChild(newdiv);
	
	var newdiv = document.createElement('div');
	var divIdName = 't';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','margin-top:-10px;font-size:16px;text-align:right;color:#2E2EFE;margin-bottom:20px;');
	if(data.length>1){
	newdiv.innerHTML =   data[1].place +" " +data[1].value + '<font size="2px"> new Reports in ' + data[data.length-1].value + ' days </font>';}
	else{
		newdiv.innerHTML="";
	}
	ni.appendChild(newdiv);
	
	var newdiv = document.createElement('div');
	var divIdName = 'th';
	newdiv.setAttribute('id',divIdName);
	newdiv.setAttribute('style','margin-top:-10px;font-size:14px;text-align:right;color:#2E2EFE;margin-bottom:20px;');
	if(data.length>2){
	newdiv.innerHTML =  data[2].place +" " +data[2].value + '<font size="2px"> new Reports in ' + data[data.length-1].value + ' days </font>';}
	else
		{
		newdiv.innerHTML="";
		}
	ni.appendChild(newdiv);
							
			var currentDate = new Date();
			$("#datesamp").datepicker("setDate", currentDate);
			
			//$("#datesamp").datepicker("setDate", currentDate);
		}
	</script>
</body>
</html>
